<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Hack Tracker</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Poppins:wght@300;400;600&display=swap');

        body { 
            margin: 0; 
            padding: 40px 20px; 
            background-color: #050505; 
            font-family: 'Poppins', sans-serif; 
            color: #fff; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            min-height: 100vh; 
        }

        h2 { 
            font-family: 'Orbitron', sans-serif; 
            color: #00d4ff; 
            text-shadow: 0 0 10px #00d4ff; 
            font-size: 36px; 
            margin-bottom: 40px; 
            text-transform: uppercase; 
        }

        .nav-btn { 
            position: absolute; 
            top: 20px; 
            left: 20px; 
            text-decoration: none; 
            color: #00ff88; 
            font-weight: bold; 
            border: 1px solid #00ff88; 
            padding: 10px 20px; 
            border-radius: 20px; 
            font-family: 'Orbitron', sans-serif; 
            transition: 0.3s; 
            cursor: pointer; 
        }

        .nav-btn:hover { 
            background: #00ff88; 
            color: #000; 
            box-shadow: 0 0 15px #00ff88; 
        }

        .list-container { 
            width: 100%; 
            max-width: 900px; 
            display: grid; 
            grid-template-columns: 1fr; 
            gap: 25px; 
        }

        @media(min-width: 768px) { 
            .list-container { grid-template-columns: 1fr 1fr; } 
        }

        .hackathon-card { 
            background: rgba(20, 20, 20, 0.9); 
            border: 1px solid #333; 
            border-top: 5px solid #00d4ff; 
            padding: 30px; 
            border-radius: 15px; 
            transition: 0.3s; 
            position: relative; 
            cursor: pointer; 
        }

        .hackathon-card:hover { 
            transform: translateY(-8px); 
            border-top-color: #00ff88; 
            box-shadow: 0 15px 30px rgba(0, 212, 255, 0.15); 
        }

        .title { 
            font-size: 28px; 
            font-weight: 800; 
            margin-bottom: 5px; 
            font-family: 'Orbitron', sans-serif; 
            text-shadow: 0 0 5px rgba(255,255,255,0.3); 
        }

        .organizer { 
            font-size: 14px; 
            color: #888; 
            margin-bottom: 20px; 
            display: block; 
        }

        .date-highlight { 
            font-size: 18px; 
            font-weight: bold; 
            color: #ffeb3b; 
            margin-bottom: 15px; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            text-shadow: 0 0 8px rgba(255, 235, 59, 0.4); 
        }

        .info-row { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 8px; 
            font-size: 14px; 
            color: #ccc; 
        }

        .badge { 
            font-size: 12px; 
            padding: 5px 10px; 
            border-radius: 5px; 
            background: #222; 
            border: 1px solid #444; 
        }

        .badge.yes { border-color: #00ff88; color: #00ff88; }
        .badge.no { border-color: #ff4444; color: #ff4444; }

        .team-code-box { 
            background: #111; 
            padding: 12px; 
            margin-top: 20px; 
            border-radius: 8px; 
            text-align: center; 
            font-family: monospace; 
            color: #00d4ff; 
            border: 1px dashed #333; 
            font-size: 16px; 
        }

        .visit-btn { 
            display: block; 
            width: 100%; 
            text-align: center; 
            background: #00d4ff; 
            color: #000; 
            padding: 12px 0; 
            border-radius: 8px; 
            margin-top: 15px; 
            text-decoration: none; 
            font-weight: bold; 
            font-family: 'Orbitron', sans-serif; 
            transition: 0.2s; 
        }

        .visit-btn:hover { 
            background: #fff; 
        }

        .footer { 
            margin-top: 50px; 
            font-size: 14px; 
            color: #888; 
            font-family: 'Orbitron', sans-serif; 
        }

        .footer span { 
            color: #00ff88; 
            font-weight: bold; 
        }
    </style>
</head>
<body>
    
    <a href="javascript:void(0)" onclick="goToAdd()" class="nav-btn">‚ûï ADD EVENT (Team)</a>
    
    <h2>UPCOMING EVENTS üöÄ</h2>

    <div class="list-container" id="hackList">
        <p style="text-align: center; color: #555;">Loading Data...</p>
    </div>

    <div class="footer">Made by <span>BitRise</span> üöÄ</div>

    <audio id="hoverSound" src="https://codeskulptor-demos.commondatastorage.googleapis.com/pang/pop.mp3"></audio>

    <script>
        // ü™Ñ MAGIC URL SWITCHER (Local vs Live Check)
        const API_URL = (window.location.hostname === "127.0.0.1" || window.location.hostname === "localhost") 
            ? "http://localhost:5000/api/hackathons"
            : "https://hackathontracker.onrender.com/api/hackathons";
        
        const listDiv = document.getElementById('hackList');
        const audio = document.getElementById("hoverSound");

        // Sound Function
        function playSound() { 
            audio.currentTime = 0; 
            audio.volume = 0.4; 
            audio.play().catch(e => console.log("Sound needs interaction first")); 
        }

        // Add Button Logic
        function goToAdd() {
            if (localStorage.getItem("isTeamMember") === "true") {
                window.location.href = "index.html";
            } else {
                window.location.href = "login.html";
            }
        }

        // Load Data Logic
        async function loadHackathons() {
            try {
                const res = await fetch(API_URL); 
                const data = await res.json(); 
                listDiv.innerHTML = "";
                
                if (data.length === 0) { 
                    listDiv.innerHTML = "<p style='color:#777; text-align:center;'>No hackathons added yet.</p>"; 
                    return; 
                }

                data.forEach(hack => {
                    const pptClass = hack.pptNeeded === 'Yes' ? 'yes' : 'no'; 
                    const regClass = hack.registered === 'Yes' ? 'yes' : 'no';
                    
                    const card = `
                        <div class="hackathon-card" onmouseenter="playSound()">
                            <div class="title">${hack.name}</div>
                            <div class="date-highlight">
                                üìÖ ${hack.startDate} <span style="font-size:12px; color:#aaa;">to</span> ${hack.endDate}
                            </div>
                            <span class="organizer">By ${hack.organizer}</span>
                            <div class="info-row">
                                <span>üìç ${hack.location} (${hack.mode})</span>
                            </div>
                            <div style="margin-top: 15px; display:flex; gap:8px; flex-wrap:wrap;">
                                <span class="badge ${pptClass}">PPT: ${hack.pptNeeded}</span>
                                <span class="badge ${regClass}">Reg: ${hack.registered}</span>
                                <span class="badge">üë• Team: ${hack.teamSize}</span>
                            </div>
                            <div class="team-code-box">Code: ${hack.teamCode || 'N/A'}</div>
                            <a href="${hack.link}" target="_blank" class="visit-btn">VISIT WEBSITE ‚Üó</a>
                        </div>`;
                    
                    listDiv.innerHTML += card;
                });
            } catch (err) { 
                listDiv.innerHTML = "<p style='color:red'>Server Error! Check backend.</p>"; 
            }
        }

        loadHackathons();
    </script>
</body>
</html>